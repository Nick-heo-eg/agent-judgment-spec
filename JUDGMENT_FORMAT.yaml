# Judgment Format Specification v1.0

# This file defines the standard format for agent judgment records.
# Every autonomous action should produce a judgment trace in this format.

judgment_id: "jdg_2026-01-29_abc123"  # Unique identifier
timestamp: "2026-01-29T12:34:56Z"      # ISO 8601 UTC

# ============================================================
# AGENT CONTEXT
# ============================================================
agent:
  name: "agent-framework-a"
  version: "1.2.3"
  session_id: "sess_xyz789"
  user_id: "user_email@example.com"  # Or anonymous identifier

# ============================================================
# ACTION PROPOSAL
# ============================================================
action:
  type: "EXEC"  # One of: READ, WRITE, EXEC (see ACTION_TAXONOMY.md)
  tool: "git"
  command: "git push origin main"
  targets:
    - "origin/main"
  scope: "repository"
  estimated_impact: "public_release"

# ============================================================
# JUDGMENT DECISION
# ============================================================
decision:
  outcome: "block"  # One of: allow, block, escalate
  reason: "Push to main requires human approval"
  rationale: "Organization policy P-2024-003 requires explicit approval for main branch modifications"
  rule_id: "rule_exec_001"
  confidence: 1.0  # Confidence in judgment correctness (0.0 to 1.0), not execution success

# ============================================================
# RESPONSIBILITY
# ============================================================
responsibility:
  # Who bears final accountability for this action
  accountable_party: "user"  # One of: agent, user, organization, policy
  decision_maker: "agent"     # Who made the judgment
  authority_source: "organization_policy"  # Basis for decision authority
  binding: false  # Reserved for implementations that support non-repudiable binding

# ============================================================
# ESCALATION (structural definition)
# ============================================================
escalation:
  # Conditions under which judgment is deferred to higher authority
  triggered: true
  target_authority: "user"  # Where judgment is escalated to
  condition: "action_type_exec_on_protected_branch"
  # NOTE: This defines WHAT escalates, not HOW enforcement works

# ============================================================
# APPROVAL CHAIN (if applicable)
# ============================================================
approval:
  required: true
  approver_id: "user_email@example.com"
  approved_at: null  # Filled when approval granted
  method: "cli_prompt"  # cli_prompt, web_ui, api

# ============================================================
# TRACE & AUDIT
# ============================================================
trace:
  conversation_id: "conv_abc123"
  prior_actions: 3  # Number of actions in this session
  risk_score: 0.85  # Cumulative risk assessment

audit:
  logged: true
  sealed: false  # Reserved for implementations that support non-repudiable seal
  compliance_tags:
    - "supply_chain"
    - "ci_cd_modification"

# ============================================================
# EXTENSIBILITY
# ============================================================
metadata:
  framework: "org/agent-framework-a"
  custom_fields: {}  # For framework-specific extensions

---

# EXAMPLE: Allowed READ action
judgment_id: "jdg_2026-01-29_read001"
timestamp: "2026-01-29T12:30:00Z"

agent:
  name: "agent-framework-b"
  version: "0.41.0"
  session_id: "sess_read123"

action:
  type: "READ"
  tool: "cat"
  command: "cat src/main.py"
  targets:
    - "src/main.py"

decision:
  outcome: "allow"
  reason: "Read action, no modification"
  rationale: "READ actions require no approval under default policy"
  rule_id: "rule_read_001"
  confidence: 1.0

responsibility:
  accountable_party: "agent"
  decision_maker: "agent"
  authority_source: "default_policy"
  binding: false  # Reserved for implementations that support non-repudiable binding

escalation:
  triggered: false
  target_authority: null
  condition: null

approval:
  required: false

trace:
  conversation_id: "conv_read123"
  prior_actions: 0
  risk_score: 0.0

---

# EXAMPLE: Escalated WRITE action
judgment_id: "jdg_2026-01-29_write001"
timestamp: "2026-01-29T12:32:00Z"

agent:
  name: "agent-framework-c"
  version: "2.0.0"
  session_id: "sess_write123"

action:
  type: "WRITE"
  tool: "edit"
  command: "edit package.json"
  targets:
    - "package.json"
  scope: "dependency_manifest"

decision:
  outcome: "escalate"
  reason: "Dependency changes require security review"
  rationale: "Supply chain policy SC-2025-001 mandates review for dependency manifest modifications"
  rule_id: "rule_write_003"
  confidence: 0.9

responsibility:
  accountable_party: "organization"
  decision_maker: "agent"
  authority_source: "supply_chain_policy"
  binding: false  # Reserved for implementations that support non-repudiable binding

escalation:
  triggered: true
  target_authority: "organization_security_team"
  condition: "dependency_manifest_modification"

approval:
  required: true
  approver_id: null  # Awaiting assignment
  method: "web_ui"

trace:
  conversation_id: "conv_write123"
  prior_actions: 5
  risk_score: 0.6

audit:
  compliance_tags:
    - "supply_chain"
    - "sbom_affected"

---

# Schema Notes:
# 1. All timestamps must be UTC ISO 8601
# 2. decision.outcome is REQUIRED
# 3. decision.rationale must be audit-defensible (not just technical reason)
# 4. responsibility.accountable_party defines who bears final accountability
# 5. escalation defines WHAT triggers deferral, not HOW enforcement works
# 6. action.type must match ACTION_TAXONOMY.md
# 7. action.tool and action.command are optional, framework-specific descriptors
#    Core judgment relies on action.type and scope, not specific commands
# 8. Extensions go in metadata.custom_fields
# 9. This format defines the judgment record, not the enforcement mechanism
